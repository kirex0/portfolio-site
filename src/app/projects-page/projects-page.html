<div class="projects-page" #projectsContainer>
  <div class="projects-container">
    <h1 class="page-title">My Projects / Experience</h1>

    <div class="projects-grid">
      @for(project of visibleProjects; track project.name; let i = $index) {
        <app-project-card
          [name]="project.name"
          [subtitle]="project.subtitle"
          [imageUrl]="project.imageUrl"
          [technologies]="project.technologies"
          [deployedUrl]="project.deployedUrl"
          [repoUrl]="project.repoUrl"
          [style.--card-index]="i"
          (click)="openProjectModal(project)"
          class="clickable-card"/>
      }
    </div>

    <div class="navigation-arrows">
      @if(currentPageSignal() > 0) {
        <div class="scroll-up-arrow" (click)="scrollToPrevSet()">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 19V5M12 5L5 12M12 5L19 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
      }

      @if(canScrollDown) {
        <div class="scroll-down-arrow" (click)="scrollToNextSet()">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 5V19M12 19L5 12M12 19L19 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
      }
    </div>

    <div class="page-indicator">
      Page {{ currentPageSignal() + 1 }} of {{ totalPages }}
    </div>
  </div>

  <!-- Project Details Modal -->
  @if(isModalOpen()) {
    <div class="modal-overlay" (click)="closeModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <button class="modal-close" (click)="closeModal()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>

        @if(selectedProject()) {
          <div class="modal-header">
            <div class="modal-image-container">
              <img [src]="selectedProject()!.imageUrl" [alt]="selectedProject()!.name" class="modal-image">
            </div>
            <div class="modal-title-section">
              <h2>{{ selectedProject()!.name }}</h2>
              <p class="modal-subtitle">{{ selectedProject()!.subtitle }}</p>
            </div>
          </div>

          <div class="modal-body">
            <div class="modal-description">
              <h3>About This Project</h3>
              <p>{{ selectedProject()!.description }}</p>
            </div>

            <div class="modal-technologies">
              <h3>Technologies Used</h3>
              <div class="tech-list">
                @for(tech of selectedProject()!.technologies; track tech) {
                  <span class="tech-tag">{{ tech }}</span>
                }
              </div>
            </div>

            <div class="modal-links">
              @if(selectedProject()!.deployedUrl) {
                <a [href]="selectedProject()!.deployedUrl" target="_blank" rel="noopener noreferrer" class="modal-link deployed">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 6H6C4.89543 6 4 6.89543 4 8V18C4 19.1046 4.89543 20 6 20H16C17.1046 20 18 19.1046 18 18V14M14 4H20M20 4V10M20 4L10 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  Visit Live Site
                </a>
              }
              @if(selectedProject()!.repoUrl) {
                <a [href]="selectedProject()!.repoUrl" target="_blank" rel="noopener noreferrer" class="modal-link repo">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 19C4 20.5 4 16.5 2 16M16 22V18.13C16.0375 17.6532 15.9731 17.1738 15.811 16.7238C15.6489 16.2738 15.3929 15.8634 15.06 15.52C18.2 15.17 21.5 13.98 21.5 8.52C21.4997 7.12383 20.9627 5.7812 20 4.77C20.4559 3.54851 20.4236 2.19835 19.91 1C19.91 1 18.73 0.65 16 2.48C13.708 1.85882 11.292 1.85882 9 2.48C6.27 0.65 5.09 1 5.09 1C4.57638 2.19835 4.54414 3.54851 5 4.77C4.03013 5.7887 3.49252 7.14346 3.5 8.55C3.5 13.97 6.8 15.16 9.94 15.55C9.611 15.89 9.35726 16.2954 9.19531 16.7399C9.03335 17.1844 8.96681 17.6581 9 18.13V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  View Repository
                </a>
              }
            </div>
          </div>
        }
      </div>
    </div>
  }
</div>
